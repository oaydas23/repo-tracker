{% extends "layout.html" %}

{% block title %}
Github Latest Real Changes
{% endblock %}

{% block main %}

<body class="bg-image2">
    <form action="/commit" method="post">
        <div class="col-md-auto">
            <div class="p-1">
                <h1 class="d-flex justify-content-center">
                    <button class="btn btn-secondary btn-lg px-40" name="refresh" type="submit"
                        onclick="progressBar()">Refresh
                        Data</button>
                </h1>
            </div>
        </div>
    </form>
</body>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
<script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js">
</script>

<script>
    $(document).ready(function () {
        $('#commit-table').DataTable({
            "paging": true,
            columnDefs: [{
                targets: -1,
                className: 'dt-head-center'
            }]
        });
    });

    function progressBar() {
        var progressBar = document.getElementById("progress-bar");
        progressBar.style.display = "block";
        var duration = 15 * 60 * 1000; // 15 minutes in milliseconds
        var interval = 100; // Update interval in milliseconds
        var increment = (interval / duration) * 100; // Progress increment per update

        var progress = 0;
        var timerId = setInterval(function () {
            progress += increment;
            progressBar.style.width = progress + "%";

            if (progress >= 100) {
                clearInterval(timerId);
            }
        }, interval);
    }
</script>

<!-- Progress bar element -->
<div class="mb-2" id="progress-bar"></div>


<table id="commit-table" class="table table-striped table-bordered table-sm">
    <thead>
        <tr class=table-header>
            <th class="th-sm">Repository</th>
            <th class="w-50">Commit</th>
            <th>Author</th>
            <th>Date</th>
            <th>Archived</th>
        </tr>
    </thead>
    <tbody>
        {% for row in data %}
        <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
            <td>{{ row[2] }}</td>
            <td>{{ row[3] }}</td>
            <td>{{ row[4] }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}